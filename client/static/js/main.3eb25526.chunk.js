(this.webpackJsonpquoteofthedayclient=this.webpackJsonpquoteofthedayclient||[]).push([[0],{102:function(e,t,n){},103:function(e,t,n){},104:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(49),i=n.n(a),o=(n(57),n(3)),u=n.n(o),s=n(6),d=n(5),l=(n(59),n(1));function m(e){return Object(l.jsx)("div",{children:Object(l.jsx)("h1",{children:e.Title})})}var f=n(15),h=n.n(f),p=n(24),j=n(30),b=n.n(j);function O(e){return new Promise(function(){var t=Object(s.a)(u.a.mark((function t(n){var r,c,a,i,o,s,d;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i in r=void 0,void 0!==e.auth&&(r={Authorization:"Bearer "+e.auth}),c=new Headers(Object(p.a)(Object(p.a)({"Content-Type":"application/x-www-form-urlencoded"},r),e.headers)),a=new FormData,e.data)e.data.hasOwnProperty(i)&&a.append(i,e.data[i]);return o={method:e.method,headers:c,mode:"cors",credentials:"same-origin"},"GET"!==e.method?o.body=b.a.stringify(e.data):(e.url+="?"+b.a.stringify(e.data),delete o.body),t.next=9,fetch(e.url,o);case 9:return s=t.sent,d=void 0,t.prev=11,t.next=14,s.json();case 14:d=t.sent,t.next=20;break;case 17:t.prev=17,t.t0=t.catch(11),d=s;case 20:n(Object(p.a)({status:s.status,url:s.url,ok:s.ok},d));case 21:case"end":return t.stop()}}),t,null,[[11,17]])})));return function(e){return t.apply(this,arguments)}}())}var x=n(2),v=n.p+"static/media/heart.c759f248.svg",g=n.p+"static/media/message.06932878.svg",k=n(50),y=n.n(k)()();n(94);function S(e){var t=Object(r.useState)(!1),n=Object(d.a)(t,2),c=n[0],a=n[1],i=Object(r.useState)(null!=e.quoteDocument.likes.find((function(t){return t===e.fingerprint}))),o=Object(d.a)(i,2),m=(o[0],o[1]);function f(){return(f=Object(s.a)(u.a.mark((function t(){var n,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.quoteDocument.likes.findIndex((function(t){return t===e.fingerprint})),m(r=n<0),y.emit("like",{id:e.quoteDocument._id,like:r,fingerprint:e.fingerprint}),t.next=6,O({url:"/quote/like",method:"PATCH",data:{fingerprint:e.fingerprint,like:r,id:e.quoteDocument._id}});case 6:e.locallyChangeQuote(e.quoteDocument._id);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function p(){return(p=Object(s.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!confirm("Vill du verkligen ta bort denna quote")){t.next=8;break}return t.next=4,O({url:"/quote",method:"DELETE",data:{id:e.quoteDocument._id}});case 4:e.deleteQuoteLocally(e.quoteDocument._id),y.emit("deleteQuote",e.quoteDocument._id),t.next=9;break;case 8:return t.abrupt("return");case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(l.jsxs)("div",{className:"all",children:[Object(l.jsxs)("div",{className:"interact_container",children:[Object(l.jsxs)("div",{className:"likes_container",children:[Object(l.jsx)("img",{onClick:function(){return f.apply(this,arguments)},className:"heart_icon",src:v,alt:""}),Object(l.jsx)("p",{children:e.quoteDocument.likes.length})]}),Object(l.jsxs)("div",{className:"comment-container",children:[Object(l.jsx)("img",{onClick:function(){a(!c)},className:"comment_icon",src:g,alt:""}),Object(l.jsx)("p",{children:e.quoteDocument.comments.length})]})]}),Object(l.jsxs)("p",{className:"quote",children:['"',e.quoteDocument.quote,'"']}),Object(l.jsx)("p",{className:"author",children:e.quoteDocument.author}),Object(l.jsx)("p",{className:"createdAt",children:h()(e.quoteDocument.createdAt).format("YY/MM/DD HH:mm")}),Object(l.jsx)("button",{className:"deleteButton",onClick:function(){return p.apply(this,arguments)},children:"Delete"}),c?Object(l.jsx)(x.a,{to:"/comments/"+e.quoteDocument._id}):null]})}function q(e){var t=Object(r.useState)(""),n=Object(d.a)(t,2),c=n[0],a=n[1],i=Object(r.useState)(""),o=Object(d.a)(i,2),m=o[0],f=o[1];function h(){return(h=Object(s.a)(u.a.mark((function t(){var n,r,i;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=c,r=m,!(c.length<=0||m.length<=0)){t.next=5;break}return alert("Du m\xe5ste fylla i author och quote"),t.abrupt("return");case 5:return t.next=7,O({url:"/quote",method:"POST",data:{author:r,quote:n}});case 7:i=t.sent,y.emit("createQuote",{id:i.quote.id,author:m,quote:c}),e.updateLocally(i.quote.id,new Date,new Date,r,n),f(""),a("");case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(l.jsxs)("div",{children:[Object(l.jsx)("input",{placeholder:"quote",value:c,onChange:function(e){return a(e.target.value)}}),Object(l.jsx)("input",{placeholder:"author",value:m,onChange:function(e){return f(e.target.value)}}),Object(l.jsx)("button",{className:"button",onClick:function(){return h.apply(this,arguments)},children:"Create"})]})}n(102);function N(e){var t=Object(r.useState)([]),n=Object(d.a)(t,2),c=n[0],a=n[1];function i(t){var n=c.findIndex((function(e){return e._id.toString()===t.toString()})),r=c[n].likes.findIndex((function(t){return t===e.fingerprint}));r<0?c[n].likes.push(e.fingerprint):c[n].likes.splice(r,1),a(JSON.parse(JSON.stringify(c)))}function o(e,t,n){var r=c.find((function(t){return t._id===e}));r?(r.comments.push({_id:(1e5*Math.random()).toString(),author:t,comment:n,createdAt:h()().toDate(),updatedAt:h()().toDate()}),a(JSON.parse(JSON.stringify(c)))):console.log("Vi kunde inte hitta commenten")}function m(e){var t=c.findIndex((function(t){return t._id===e}));if(t<0)console.log("Vi kunde inte hitta quoten");else{c.splice(t,1);var n=JSON.parse(JSON.stringify(c));a(n)}}return Object(r.useEffect)((function(){return y.on("like",(function(e){var t=c.find((function(t){return t._id.toString()===e.id}));if(void 0!==t){var n=t.likes.findIndex((function(t){return t===e.fingerprint}));-1===n?t.likes.push(e.fingerprint):t.likes.splice(n),a(JSON.parse(JSON.stringify(c)))}})),y.on("createQuote",(function(e){c.push({_id:e.id,author:e.author,comments:[],createdAt:new Date,likes:[],quote:e.quote,updatedAt:new Date}),console.log("tjenixen ",e.quote),a(JSON.parse(JSON.stringify(c)))})),y.on("createcomment",(function(e){var t=c.find((function(t){return t._id===e.id}));void 0!==t&&(t.comments.push({_id:Math.random().toString(),author:e.author,comment:e.comment,createdAt:new Date,updatedAt:new Date}),a(JSON.parse(JSON.stringify(c))))})),y.on("deleteQuote",(function(e){var t=c.findIndex((function(t){return t._id.toString()===e}));-1!==t&&(c.splice(t),a(JSON.parse(JSON.stringify(c))))})),function(){}}),[c]),Object(r.useEffect)((function(){function e(){return(e=Object(s.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O({url:"/quote",method:"GET"});case 2:t=e.sent,a(t.quotes),console.log(t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(l.jsxs)("div",{children:[Object(l.jsx)(q,{updateLocally:function(e,t,n,r,i){c.push({_id:e,author:r,quote:i,comments:[],likes:[],createdAt:t,updatedAt:n}),a(JSON.parse(JSON.stringify(c)))}}),Object(l.jsx)("div",{className:"list-container",children:c.map((function(t){return Object(l.jsx)(S,{createCommentLocally:o,locallyChangeQuote:i,deleteQuoteLocally:m,fingerprint:e.fingerprint,quoteDocument:{_id:t._id,author:t.author,quote:t.quote,comments:t.comments,likes:t.likes,createdAt:h()(t.createdAt).toDate(),updatedAt:h()(t.updatedAt).toDate()}},t._id)}))})]})}var D=n(52),w=n(21);n(103);function _(e){var t=Object(r.useState)(""),n=Object(d.a)(t,2),c=n[0],a=n[1],i=Object(r.useState)(""),o=Object(d.a)(i,2),m=o[0],f=o[1];function h(){return(h=Object(s.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==c.length&&0!==m.length){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,O({url:"/quote/comment",method:"POST",data:{author:c,comment:m,id:e.id}});case 4:n=t.sent,y.emit("createcomment",{id:e.id,comment:m,author:c}),e.createCommentLocally(e.id,c,m),f(""),a(""),console.log(n);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(l.jsxs)("div",{children:[Object(l.jsx)("input",{placeholder:"Comment",value:m,onChange:function(e){return f(e.target.value)}}),Object(l.jsx)("input",{placeholder:"Author",value:c,onChange:function(e){return a(e.target.value)}}),Object(l.jsx)("button",{onClick:function(){return h.apply(this,arguments)},children:"Submit"})]})}function A(e){var t=Object(r.useState)(void 0),n=Object(d.a)(t,2),c=n[0],a=n[1];return Object(r.useEffect)((function(){O({url:"/quote",method:"GET",data:{id:e.match.params.id}}).then((function(e){a(e)}))}),[e.match.params.id]),Object(r.useEffect)((function(){y.on("createcomment",(function(e){void 0!==c&&(c.comments.push({_id:Math.random().toString(),author:e.author,comment:e.comment,createdAt:new Date,updatedAt:new Date}),a(JSON.parse(JSON.stringify(c))))}))})),void 0===c?null:Object(l.jsxs)("div",{children:[Object(l.jsx)(w.b,{className:"home-btn",to:"/",children:"Home"}),Object(l.jsx)("div",{className:"all-the-sutff-for-create-comments-yes",children:Object(l.jsx)(_,{id:e.match.params.id,createCommentLocally:function(e,t,n){console.log(e,t,n),null===c||void 0===c||c.comments.push({comment:n,_id:e,author:t,createdAt:new Date,updatedAt:new Date}),a(JSON.parse(JSON.stringify(c)))}})}),c.comments.map((function(e){return Object(l.jsxs)("div",{className:"commentContainer",children:[Object(l.jsxs)("p",{className:"commentText",children:[' "',e.comment,'"']}),Object(l.jsxs)("p",{className:"commentAText",children:[" ",e.author]})]},e._id)}))]})}var C=function(){var e=Object(r.useState)(""),t=Object(d.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){return y.emit("ping",""),Object(s.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.a.load();case 2:return t=e.sent,e.next=5,t.get();case 5:n=e.sent,c(n.visitorId);case 7:case"end":return e.stop()}}),e)})))(),function(){}}),[]),Object(l.jsx)(w.a,{children:Object(l.jsxs)(x.d,{children:[Object(l.jsx)(x.b,{path:"/comments/:id",component:A}),Object(l.jsx)(x.b,{path:"/",children:Object(l.jsxs)("div",{className:"App",children:[Object(l.jsx)(m,{Title:"Quote of the day"}),Object(l.jsx)(N,{fingerprint:n})]})})]})})},J=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,105)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),c(e),a(e),i(e)}))};i.a.render(Object(l.jsx)(c.a.StrictMode,{children:Object(l.jsx)(C,{})}),document.getElementById("root")),J()},57:function(e,t,n){},59:function(e,t,n){},94:function(e,t,n){}},[[104,1,2]]]);
//# sourceMappingURL=main.3eb25526.chunk.js.map